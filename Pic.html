<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>PicShine AI - Mobile Enhanced</title>
    
    <!-- External Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#4D3DF4">
    <meta name="description" content="Transform your photos with AI-powered enhancement. Super-resolution, face enhancement, colorization and more.">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="PicShine AI">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIlBpY1NoaW5lIEFJIiwKICAic2hvcnRfbmFtZSI6ICJQaWNTaGluZSIsCiAgInN0YXJ0X3VybCI6ICIvIiwKICAiZGlzcGxheSI6ICJzdGFuZGFsb25lIiwKICAiYmFja2dyb3VuZF9jb2xvciI6ICIjMEUwRTEyIiwKICAidGhlbWVfY29sb3IiOiAiIzREM0RGNCIsCiAgImljb25zIjogWwogICAgewogICAgICAic3JjIjogImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU1USTRJaUJvWldsbmFIUTlJakV5T0NJZ2RtbGxkMEp2ZUQwaU1DQXdJREV5T0NBeU9DSWdabWxzYkQwaUl6UkVNMFJHUkNJK1BHTnBlR05zWlNCamVEMGlOalFpSUdONVBTSTJOQ0lnY2owaU1UWWlJR1pwYkd3OUluZG9hWFJsSWk4K1BIUmxlSFFnZUQwaU1qUWlJSGs5SWpjMElpQm1hV3hzUFNKM2FHbDBaU0lnZEc5NGRDMWhibU5vYjNJOUltMXBaR1JzWlNJK1VFRERDZ0JqVTJocGJtVUtQQzl6ZG1jKyIsCiAgICAgICJzaXplcyI6ICIxMjh4MTI4IiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIKICAgIH0KICBdCn0=">
    
    <!-- Ad Scripts -->
    <script type='text/javascript' src='//pl26935680.profitableratecpm.com/2e/32/93/2e3293b3df54f78268437bf3626a0e36.js'></script>
    <script async="async" data-cfasync="false" src="//pl26935397.profitableratecpm.com/242b734757198216a6ef5b94eae86475/invoke.js"></script>

    <style>
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0E0E12 0%, #1A1A26 100%);
            color: #E5E7EB;
            transition: all 0.3s ease;
            overscroll-behavior: contain;
            touch-action: manipulation;
        }
        
        body.light-mode {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            color: #1f2937;
        }
        
        /* Enhanced Mobile Logo */
        .logo-container {
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, #4D3DF4 0%, #AB3FFB 50%, #1E90FF 100%);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 12px 40px rgba(77, 61, 244, 0.4);
            animation: logoGlow 3s ease-in-out infinite alternate;
        }
        
        @keyframes logoGlow {
            0% { box-shadow: 0 12px 40px rgba(77, 61, 244, 0.4); }
            100% { box-shadow: 0 16px 50px rgba(77, 61, 244, 0.6); }
        }
        
        .logo-container::before {
            content: '';
            position: absolute;
            top: -3px;
            right: -3px;
            width: 16px;
            height: 16px;
            background: linear-gradient(45deg, #1E90FF, #00FFFF);
            border-radius: 50%;
            box-shadow: 0 0 12px #1E90FF;
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.8; }
        }
        
        .logo-container i {
            color: white;
            font-size: 28px;
        }
        
        /* Enhanced Glass Effect */
        .glass-card {
            background: rgba(26, 26, 38, 0.8);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .glass-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
        }
        
        .light-mode .glass-card {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }
        
        /* Enhanced Gradient Buttons */
        .gradient-button {
            background: linear-gradient(45deg, #4D3DF4, #AB3FFB, #1E90FF, #00FFFF);
            background-size: 300% 300%;
            animation: gradientFlow 4s ease infinite;
            transition: all 0.3s ease;
            border: none;
            position: relative;
            overflow: hidden;
            min-height: 48px;
        }
        
        .gradient-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }
        
        .gradient-button:hover::before {
            transform: translateX(100%);
        }
        
        .gradient-button:active {
            transform: scale(0.98);
        }
        
        @keyframes gradientFlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        /* Mobile-Optimized Ad Containers */
        .ad-container {
            background: rgba(26, 26, 38, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 12px;
            margin: 12px 0;
            min-height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        
        .ad-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(77, 61, 244, 0.1), transparent);
            animation: adShimmer 3s ease-in-out infinite;
        }
        
        @keyframes adShimmer {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
        }
        
        .light-mode .ad-container {
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .ad-label {
            position: absolute;
            top: 8px;
            right: 8px;
            background: linear-gradient(45deg, #4D3DF4, #AB3FFB);
            color: white;
            padding: 4px 12px;
            border-radius: 8px;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
            z-index: 10;
        }
        
        /* Enhanced Mobile Image Processing */
        .image-container {
            position: relative;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }
        
        .image-container:hover {
            transform: translateY(-4px);
            box-shadow: 0 16px 50px rgba(0, 0, 0, 0.4);
        }
        
        .comparison-slider {
            position: relative;
            width: 100%;
            height: 350px;
            overflow: hidden;
            border-radius: 16px;
            cursor: ew-resize;
            touch-action: none;
        }
        
        .comparison-slider img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            user-select: none;
        }
        
        .comparison-overlay {
            position: absolute;
            top: 0;
            right: 0;
            width: 50%;
            height: 100%;
            overflow: hidden;
            z-index: 2;
        }
        
        .comparison-divider {
            position: absolute;
            top: 0;
            left: 50%;
            width: 6px;
            height: 100%;
            background: linear-gradient(to bottom, #4D3DF4, #AB3FFB, #1E90FF);
            cursor: ew-resize;
            z-index: 3;
            box-shadow: 0 0 20px rgba(77, 61, 244, 0.6);
            touch-action: none;
        }
        
        .comparison-divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
            border: 2px solid #4D3DF4;
        }
        
        .comparison-divider::after {
            content: 'â†”';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #4D3DF4;
            font-weight: bold;
            font-size: 12px;
        }
        
        /* Enhanced Filter Options */
        .filter-option {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            background: rgba(55, 65, 81, 0.8);
            backdrop-filter: blur(10px);
            min-height: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            touch-action: manipulation;
        }
        
        .filter-option:active {
            transform: scale(0.95);
        }
        
        .filter-option:hover {
            transform: translateY(-2px);
            border-color: #4D3DF4;
            box-shadow: 0 8px 25px rgba(77, 61, 244, 0.3);
        }
        
        .filter-option.active {
            border-color: #AB3FFB;
            box-shadow: 0 8px 30px rgba(171, 63, 251, 0.5);
            background: linear-gradient(135deg, rgba(77, 61, 244, 0.2), rgba(171, 63, 251, 0.2));
        }
        
        .filter-option i {
            margin-bottom: 4px;
            transition: all 0.3s ease;
        }
        
        .filter-option:hover i {
            transform: scale(1.2);
        }
        
        /* Enhanced Progress Animations */
        .progress-ring {
            width: 80px;
            height: 80px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid #4D3DF4;
            border-right: 4px solid #AB3FFB;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .progress-bar {
            height: 8px;
            background: linear-gradient(90deg, #4D3DF4, #AB3FFB, #1E90FF);
            border-radius: 4px;
            transition: width 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 30%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6), transparent);
            animation: progressShimmer 2s infinite;
        }
        
        @keyframes progressShimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(400%); }
        }
        
        /* Mobile Responsive Design */
        @media (max-width: 768px) {
            .comparison-slider {
                height: 280px;
            }
            
            .filter-grid {
                grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
                gap: 8px;
            }
            
            .ad-container {
                min-height: 200px;
                margin: 8px 0;
            }
            
            .glass-card {
                margin: 8px;
                border-radius: 16px;
            }
        }
        
        /* Enhanced Toast Notifications */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(26, 26, 38, 0.95);
            backdrop-filter: blur(25px);
            color: white;
            padding: 18px 24px;
            border-radius: 12px;
            border-left: 4px solid #4D3DF4;
            transform: translateX(400px);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 1000;
            max-width: 320px;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.error {
            border-left-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }
        
        .toast.success {
            border-left-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }
        
        /* Enhanced Drop Zone */
        .drop-zone {
            border: 3px dashed rgba(77, 61, 244, 0.4);
            border-radius: 16px;
            transition: all 0.3s ease;
            background: rgba(77, 61, 244, 0.05);
            position: relative;
            overflow: hidden;
        }
        
        .drop-zone::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(77, 61, 244, 0.1), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .drop-zone:hover::before {
            opacity: 1;
        }
        
        .drop-zone.drag-over {
            border-color: #4D3DF4;
            background: rgba(77, 61, 244, 0.15);
            transform: scale(1.02);
        }
        
        .drop-zone.drag-over::before {
            opacity: 1;
        }
        
        /* Enhanced Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(15px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal.show {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: rgba(26, 26, 38, 0.98);
            backdrop-filter: blur(30px);
            border-radius: 20px;
            padding: 32px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.8) translateY(50px);
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .modal.show .modal-content {
            transform: scale(1) translateY(0);
        }
        
        .light-mode .modal-content {
            background: rgba(255, 255, 255, 0.98);
            color: #1f2937;
        }
        
        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(45deg, #4D3DF4, #AB3FFB);
            color: white;
            border: none;
            font-size: 24px;
            box-shadow: 0 8px 25px rgba(77, 61, 244, 0.4);
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 100;
        }
        
        .fab:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 30px rgba(77, 61, 244, 0.6);
        }
        
        .fab:active {
            transform: scale(0.95);
        }
        
        /* Vibration Effects */
        .vibrate-on-tap {
            transition: all 0.1s ease;
        }
        
        .vibrate-on-tap:active {
            transform: scale(0.98);
        }
        
        /* Loading Skeleton */
        .skeleton {
            background: linear-gradient(90deg, #374151 25%, #4B5563 50%, #374151 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 8px;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* Enhanced Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(55, 65, 81, 0.3);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #4D3DF4, #AB3FFB);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(45deg, #AB3FFB, #1E90FF);
        }
        
        /* Swipe Gesture Indicator */
        .swipe-indicator {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            animation: swipeBounce 2s ease-in-out infinite;
        }
        
        @keyframes swipeBounce {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-5px); }
        }
        
        /* Device Orientation Styles */
        @media (orientation: landscape) and (max-height: 500px) {
            .logo-container {
                width: 40px;
                height: 40px;
            }
            
            .logo-container i {
                font-size: 20px;
            }
            
            .glass-card {
                padding: 16px;
            }
        }
        
        /* Performance Optimizations */
        .gpu-accelerated {
            transform: translateZ(0);
            backface-visibility: hidden;
            perspective: 1000px;
        }
        
        /* Accessibility Improvements */
        .focus-visible {
            outline: 2px solid #4D3DF4;
            outline-offset: 2px;
        }
        
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Enhanced Header -->
    <header class="sticky top-0 z-50 glass-card mx-2 mt-2 rounded-3xl">
        <div class="container mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="logo-container gpu-accelerated">
                        <i class="fas fa-camera"></i>
                    </div>
                    <div>
                        <h1 class="text-lg font-bold text-white">PicShine AI</h1>
                        <p class="text-xs text-gray-400">Mobile Enhanced</p>
                    </div>
                </div>
                
                <nav class="hidden md:flex items-center space-x-6">
                    <a href="#home" class="text-gray-300 hover:text-white transition-colors">Home</a>
                    <a href="#features" class="text-gray-300 hover:text-white transition-colors">Features</a>
                    <a href="#pricing" class="text-gray-300 hover:text-white transition-colors">Pricing</a>
                    <button id="themeToggle" class="p-2 rounded-lg hover:bg-white hover:bg-opacity-10 transition-all vibrate-on-tap">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button id="premiumBtn" class="gradient-button text-white px-4 py-2 rounded-lg font-semibold vibrate-on-tap">
                        <i class="fas fa-crown mr-2"></i>Premium
                    </button>
                </nav>
                
                <button id="mobileMenuToggle" class="md:hidden p-2 rounded-lg hover:bg-white hover:bg-opacity-10 vibrate-on-tap">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Header Ad -->
    <div class="container mx-auto px-2 py-2">
        <div class="ad-container">
            <div class="ad-label">Advertisement</div>
            <div id="container-242b734757198216a6ef5b94eae86475"></div>
        </div>
    </div>

    <!-- Enhanced Mobile Menu -->
    <div id="mobileMenu" class="fixed inset-0 z-40 transform translate-x-full transition-transform md:hidden">
        <div class="glass-card h-full w-80 ml-auto p-6">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-xl font-bold">Menu</h2>
                <button id="closeMobileMenu" class="p-2 rounded-lg hover:bg-white hover:bg-opacity-10 vibrate-on-tap">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <nav class="space-y-4">
                <a href="#home" class="block text-gray-300 hover:text-white transition-colors py-3 px-4 rounded-lg hover:bg-white hover:bg-opacity-10">
                    <i class="fas fa-home mr-3"></i>Home
                </a>
                <a href="#features" class="block text-gray-300 hover:text-white transition-colors py-3 px-4 rounded-lg hover:bg-white hover:bg-opacity-10">
                    <i class="fas fa-star mr-3"></i>Features
                </a>
                <a href="#pricing" class="block text-gray-300 hover:text-white transition-colors py-3 px-4 rounded-lg hover:bg-white hover:bg-opacity-10">
                    <i class="fas fa-dollar-sign mr-3"></i>Pricing
                </a>
                <button id="mobileThemeToggle" class="flex items-center space-x-3 text-gray-300 hover:text-white transition-colors py-3 px-4 rounded-lg hover:bg-white hover:bg-opacity-10 w-full text-left vibrate-on-tap">
                    <i class="fas fa-moon"></i>
                    <span>Dark Mode</span>
                </button>
                <button class="gradient-button text-white px-4 py-3 rounded-lg font-semibold w-full mt-4 vibrate-on-tap">
                    <i class="fas fa-crown mr-2"></i>Upgrade to Premium
                </button>
            </nav>
        </div>
    </div>

    <!-- Main Content -->
    <main class="px-2 py-4">
        <!-- Enhanced Hero Section -->
        <section id="home" class="text-center mb-8">
            <h2 class="text-3xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 bg-clip-text text-transparent">
                AI Photo Enhancement
            </h2>
            <p class="text-lg text-gray-400 mb-6 max-w-2xl mx-auto px-4">
                Transform your images with cutting-edge AI technology. Super-resolution, face enhancement, colorization, and more.
            </p>
            <div class="flex justify-center space-x-4 mb-6">
                <div class="text-center">
                    <div class="text-2xl font-bold text-purple-400">50K+</div>
                    <div class="text-sm text-gray-400">Photos Enhanced</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-blue-400">99.9%</div>
                    <div class="text-sm text-gray-400">Accuracy</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-pink-400">10M+</div>
                    <div class="text-sm text-gray-400">Users</div>
                </div>
            </div>
        </section>

        <!-- Enhanced Main Enhancement Tool -->
        <section class="glass-card p-4 md:p-6 rounded-3xl mb-8">
            <!-- Enhanced Image Upload Area -->
            <div id="uploadArea" class="drop-zone p-6 text-center mb-6 cursor-pointer gpu-accelerated vibrate-on-tap">
                <div class="mb-4">
                    <div class="relative inline-block">
                        <i class="fas fa-cloud-upload-alt text-5xl text-purple-400 mb-4 gpu-accelerated"></i>
                        <div class="absolute -top-2 -right-2 w-6 h-6 bg-gradient-to-r from-purple-400 to-pink-400 rounded-full flex items-center justify-center">
                            <i class="fas fa-plus text-white text-xs"></i>
                        </div>
                    </div>
                    <h3 class="text-xl font-semibold mb-2">Upload Your Images</h3>
                    <p class="text-gray-400 mb-4">Drag and drop images here or tap to browse</p>
                    <input type="file" id="imageInput" multiple accept="image/*" class="hidden">
                    <button class="gradient-button text-white px-6 py-3 rounded-xl font-semibold vibrate-on-tap">
                        <i class="fas fa-plus mr-2"></i>Choose Images
                    </button>
                </div>
            </div>

            <!-- Content Ad -->
            <div class="ad-container mb-6">
                <div class="ad-label">Advertisement</div>
                <div style="min-height: 200px; display: flex; align-items: center; justify-content: center;">
                    <div class="text-center">
                        <i class="fas fa-ad text-4xl text-gray-400 mb-2"></i>
                        <p class="text-gray-400">Advertisement Space</p>
                    </div>
                </div>
            </div>

            <!-- Enhanced Enhancement Options -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-4 flex items-center">
                    <i class="fas fa-magic mr-2 text-purple-400"></i>
                    Enhancement Type
                </h3>
                <div class="filter-grid grid grid-cols-3 md:grid-cols-6 gap-3">
                    <div class="filter-option active vibrate-on-tap" data-filter="super-resolution">
                        <i class="fas fa-search-plus text-2xl text-purple-400 mb-1"></i>
                        <p class="text-xs font-medium">Super Resolution</p>
                    </div>
                    <div class="filter-option vibrate-on-tap" data-filter="face-enhance">
                        <i class="fas fa-user text-2xl text-blue-400 mb-1"></i>
                        <p class="text-xs font-medium">Face Enhance</p>
                    </div>
                    <div class="filter-option vibrate-on-tap" data-filter="colorize">
                        <i class="fas fa-palette text-2xl text-pink-400 mb-1"></i>
                        <p class="text-xs font-medium">Colorization</p>
                    </div>
                    <div class="filter-option vibrate-on-tap" data-filter="denoise">
                        <i class="fas fa-magic text-2xl text-green-400 mb-1"></i>
                        <p class="text-xs font-medium">Denoise</p>
                    </div>
                    <div class="filter-option vibrate-on-tap" data-filter="sharpen">
                        <i class="fas fa-eye text-2xl text-yellow-400 mb-1"></i>
                        <p class="text-xs font-medium">Sharpen</p>
                    </div>
                    <div class="filter-option vibrate-on-tap" data-filter="vintage">
                        <i class="fas fa-camera-retro text-2xl text-orange-400 mb-1"></i>
                        <p class="text-xs font-medium">Vintage</p>
                    </div>
                </div>
            </div>

            <!-- Enhanced Image Preview Grid -->
            <div id="imageGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6 hidden">
                <!-- Dynamic content -->
            </div>

            <!-- Enhanced Enhancement Controls -->
            <div class="flex flex-col space-y-3 mb-6">
                <button id="enhanceBtn" class="gradient-button text-white px-6 py-4 rounded-xl font-semibold disabled:opacity-50 disabled:cursor-not-allowed vibrate-on-tap" disabled>
                    <i class="fas fa-wand-magic-sparkles mr-2"></i>
                    Enhance Images
                </button>
                <button id="batchProcessBtn" class="bg-gray-700 hover:bg-gray-600 text-white px-6 py-4 rounded-xl font-semibold disabled:opacity-50 vibrate-on-tap" disabled>
                    <i class="fas fa-layer-group mr-2"></i>
                    Batch Process
                </button>
            </div>

            <!-- Enhanced Progress Area -->
            <div id="progressArea" class="hidden mb-6">
                <div class="flex items-center justify-between mb-3">
                    <span class="text-sm font-medium flex items-center">
                        <i class="fas fa-cog fa-spin mr-2 text-purple-400"></i>
                        Processing...
                    </span>
                    <span id="progressText" class="text-sm text-purple-400 font-semibold">0%</span>
                </div>
                <div class="w-full bg-gray-700 rounded-full h-2 mb-4">
                    <div id="progressBar" class="progress-bar h-2 rounded-full" style="width: 0%"></div>
                </div>
                <div class="flex justify-center">
                    <div class="progress-ring"></div>
                </div>
            </div>

            <!-- Enhanced Comparison Slider -->
            <div id="comparisonArea" class="hidden mb-6">
                <h3 class="text-lg font-semibold mb-4 flex items-center">
                    <i class="fas fa-balance-scale mr-2 text-purple-400"></i>
                    Before & After
                </h3>
                <div class="comparison-slider gpu-accelerated" id="comparisonSlider">
                    <img id="originalImage" src="" alt="Original" class="w-full h-full object-cover">
                    <div class="comparison-overlay" id="comparisonOverlay">
                        <img id="enhancedImage" src="" alt="Enhanced" class="w-full h-full object-cover">
                    </div>
                    <div class="comparison-divider" id="comparisonDivider"></div>
                    <div class="swipe-indicator">
                        <i class="fas fa-arrows-alt-h mr-1"></i>
                        Swipe to compare
                    </div>
                </div>
                
                <!-- Enhanced Comparison Labels -->
                <div class="flex justify-between mt-3 text-sm text-gray-400">
                    <span class="flex items-center">
                        <i class="fas fa-image mr-1"></i>Original
                    </span>
                    <span class="flex items-center">
                        <i class="fas fa-star mr-1"></i>Enhanced
                    </span>
                </div>
            </div>

            <!-- Enhanced Action Buttons -->
            <div id="actionButtons" class="grid grid-cols-2 md:grid-cols-4 gap-3 hidden">
                <button id="downloadBtn" class="gradient-button text-white px-4 py-3 rounded-xl font-semibold vibrate-on-tap">
                    <i class="fas fa-download mr-2"></i>Download
                </button>
                <button id="shareBtn" class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-3 rounded-xl font-semibold vibrate-on-tap">
                    <i class="fas fa-share-alt mr-2"></i>Share
                </button>
                <button id="undoBtn" class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-3 rounded-xl font-semibold disabled:opacity-50 vibrate-on-tap" disabled>
                    <i class="fas fa-undo mr-2"></i>Undo
                </button>
                <button id="redoBtn" class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-3 rounded-xl font-semibold disabled:opacity-50 vibrate-on-tap" disabled>
                    <i class="fas fa-redo mr-2"></i>Redo
                </button>
            </div>
        </section>

        <!-- Enhanced Features Section -->
        <section id="features" class="mb-8">
            <h2 class="text-3xl font-bold text-center mb-6">Powerful AI Features</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div class="glass-card p-6 rounded-2xl text-center hover:transform hover:scale-105 transition-all duration-300 gpu-accelerated">
                    <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-purple-400 to-purple-600 rounded-full flex items-center justify-center">
                        <i class="fas fa-search-plus text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">Super Resolution</h3>
                    <p class="text-gray-400 text-sm">Upscale images up to 4x while preserving quality and adding fine details.</p>
                </div>
                <div class="glass-card p-6 rounded-2xl text-center hover:transform hover:scale-105 transition-all duration-300 gpu-accelerated">
                    <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center">
                        <i class="fas fa-user-circle text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">Face Enhancement</h3>
                    <p class="text-gray-400 text-sm">Intelligently enhance facial features and skin texture with AI precision.</p>
                </div>
                <div class="glass-card p-6 rounded-2xl text-center hover:transform hover:scale-105 transition-all duration-300 gpu-accelerated">
                    <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-pink-400 to-pink-600 rounded-full flex items-center justify-center">
                        <i class="fas fa-palette text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">Auto Colorization</h3>
                    <p class="text-gray-400 text-sm">Bring black and white photos to life with realistic color restoration.</p>
                </div>
                <div class="glass-card p-6 rounded-2xl text-center hover:transform hover:scale-105 transition-all duration-300 gpu-accelerated">
                    <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-green-400 to-green-600 rounded-full flex items-center justify-center">
                        <i class="fas fa-magic text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">Noise Reduction</h3>
                    <p class="text-gray-400 text-sm">Remove noise and grain while maintaining image sharpness and clarity.</p>
                </div>
                <div class="glass-card p-6 rounded-2xl text-center hover:transform hover:scale-105 transition-all duration-300 gpu-accelerated">
                    <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center">
                        <i class="fas fa-layer-group text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">Batch Processing</h3>
                    <p class="text-gray-400 text-sm">Process multiple images simultaneously with consistent quality results.</p>
                </div>
                <div class="glass-card p-6 rounded-2xl text-center hover:transform hover:scale-105 transition-all duration-300 gpu-accelerated">
                    <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-orange-400 to-orange-600 rounded-full flex items-center justify-center">
                        <i class="fas fa-mobile-alt text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">Cross-Platform</h3>
                    <p class="text-gray-400 text-sm">Works seamlessly on desktop, tablet, and mobile devices.</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Enhanced Footer -->
    <footer class="glass-card mx-2 mb-2 rounded-3xl">
        <div class="container mx-auto px-6 py-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div>
                    <div class="flex items-center space-x-3 mb-4">
                        <div class="logo-container w-10 h-10">
                            <i class="fas fa-camera text-sm"></i>
                        </div>
                        <span class="text-lg font-bold">PicShine AI</span>
                    </div>
                    <p class="text-gray-400 text-sm">Transform your photos with cutting-edge AI technology.</p>
                </div>
                <div>
                    <h4 class="font-semibold mb-3">Product</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="#" class="hover:text-white transition-colors">Features</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Pricing</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">API</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold mb-3">Support</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="#" class="hover:text-white transition-colors">Help Center</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Contact</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Status</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold mb-3">Connect</h4>
                    <div class="flex space-x-3">
                        <a href="#" class="text-gray-400 hover:text-purple-400 transition-colors">
                            <i class="fab fa-twitter text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-purple-400 transition-colors">
                            <i class="fab fa-instagram text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-purple-400 transition-colors">
                            <i class="fab fa-github text-xl"></i>
                        </a>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-6 pt-4 text-center text-sm text-gray-400">
                <p>&copy; 2024 PicShine AI. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Footer Ad -->
    <div class="container mx-auto px-2 pb-2">
        <div class="ad-container">
            <div class="ad-label">Advertisement</div>
            <div style="min-height: 150px; display: flex; align-items: center; justify-content: center;">
                <div class="text-center">
                    <i class="fas fa-ad text-3xl text-gray-400 mb-2"></i>
                    <p class="text-gray-400">Footer Advertisement</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Premium Modal -->
    <div id="premiumModal" class="modal">
        <div class="modal-content">
            <div class="text-center">
                <div class="w-20 h-20 mx-auto mb-4 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center">
                    <i class="fas fa-crown text-3xl text-white"></i>
                </div>
                <h2 class="text-2xl font-bold mb-4">Upgrade to Premium</h2>
                <p class="text-gray-400 mb-6">Unlock unlimited enhancements, batch processing, and exclusive features</p>
                
                <div class="space-y-4 mb-6 text-left">
                    <div class="flex items-center space-x-3 p-3 bg-green-500 bg-opacity-10 rounded-lg">
                        <i class="fas fa-check text-green-400"></i>
                        <span>Unlimited image enhancements</span>
                    </div>
                    <div class="flex items-center space-x-3 p-3 bg-green-500 bg-opacity-10 rounded-lg">
                        <i class="fas fa-check text-green-400"></i>
                        <span>Batch processing up to 100 images</span>
                    </div>
                    <div class="flex items-center space-x-3 p-3 bg-green-500 bg-opacity-10 rounded-lg">
                        <i class="fas fa-check text-green-400"></i>
                        <span>Priority processing queue</span>
                    </div>
                    <div class="flex items-center space-x-3 p-3 bg-green-500 bg-opacity-10 rounded-lg">
                        <i class="fas fa-check text-green-400"></i>
                        <span>Advanced AI models</span>
                    </div>
                </div>
                
                <div class="flex flex-col space-y-3">
                    <button class="gradient-button text-white px-6 py-4 rounded-xl font-semibold vibrate-on-tap">
                        <i class="fas fa-credit-card mr-2"></i>
                        Subscribe Now - $9.99/month
                    </button>
                    <button id="closePremiumModal" class="bg-gray-700 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-semibold vibrate-on-tap">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <button id="fabButton" class="fab vibrate-on-tap" title="Quick Actions">
        <i class="fas fa-plus"></i>
    </button>

    <!-- Toast Container -->
    <div id="toastContainer"></div>

    <script>
        class PicShineAI {
            constructor() {
                this.images = [];
                this.currentFilter = 'super-resolution';
                this.history = [];
                this.historyIndex = -1;
                this.isDragging = false;
                this.touchStartX = 0;
                this.touchStartY = 0;
                this.isProcessing = false;
                
                this.initializeEventListeners();
                this.setupDragAndDrop();
                this.setupComparisonSlider();
                this.setupTouchGestures();
                this.initializeAds();
                this.initializePWA();
                this.setupDeviceFeatures();
            }

            initializeAds() {
                setTimeout(() => {
                    try {
                        const adContainer = document.getElementById('container-242b734757198216a6ef5b94eae86475');
                        if (adContainer) {
                            console.log('Ad container found and initialized');
                        }
                    } catch (error) {
                        console.log('Ad initialization:', error);
                    }
                }, 2000);
            }

            initializePWA() {
                // Install prompt
                let deferredPrompt;
                window.addEventListener('beforeinstallprompt', (e) => {
                    e.preventDefault();
                    deferredPrompt = e;
                    this.showInstallPrompt();
                });

                // Service worker registration
                if ('serviceWorker' in navigator) {
                    window.addEventListener('load', () => {
                        navigator.serviceWorker.register('data:application/javascript;base64,Y29uc3QgQ0FDSEVfTkFNRSA9ICdwaWNzaGluZS1haS1tb2JpbGUtdjEnOwpjb25zdCB1cmxzVG9DYWNoZSA9IFsKICAgICcvJywKICAgICcvaW5kZXguaHRtbCcsCiAgICAnaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS90YWlsd2luZGNzc0AyLjIuMTkvZGlzdC90YWlsd2luZC5taW4uY3NzJywKICAgICdodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL0Bmb3J0YXdlc29tZS9mb250YXdlc29tZS1mcmVlQDYuNC4wL2Nzcy9hbGwubWluLmNzcycKXTsKCnNlbGYuYWRkRXZlbnRMaXN0ZW5lcignaW5zdGFsbCcsIGV2ZW50ID0+IHsKICAgIGV2ZW50LndhaXRVbnRpbCgKICAgICAgICBjYWNoZXMub3BlbihDQUNIRV9OQU1FKS50aGVuKGNhY2hlID0+IHsKICAgICAgICAgICAgcmV0dXJuIGNhY2hlLmFkZEFsbCh1cmxzVG9DYWNoZSk7CiAgICAgICAgfSkKICAgICk7Cn0pOwoKc2VsZi5hZGRFdmVudExpc3RlbmVyKCdmZXRjaCcsIGV2ZW50ID0+IHsKICAgIGV2ZW50LnJlc3BvbmRXaXRoKAogICAgICAgIGNhY2hlcy5tYXRjaChldmVudC5yZXF1ZXN0KS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8IGZldGNoKGV2ZW50LnJlcXVlc3QpOwogICAgICAgIH0pCiAgICApOwp9KTs=')
                        .then(registration => console.log('SW registered:', registration))
                        .catch(error => console.log('SW registration failed:', error));
                    });
                }
            }

            setupDeviceFeatures() {
                // Vibration support
                this.vibrationSupported = 'vibrate' in navigator;
                
                // Device orientation
                if (screen.orientation) {
                    screen.orientation.addEventListener('change', () => {
                        this.handleOrientationChange();
                    });
                }

                // Battery API
                if ('getBattery' in navigator) {
                    navigator.getBattery().then(battery => {
                        this.monitorBattery(battery);
                    });
                }

                // Network information
                if ('connection' in navigator) {
                    this.monitorNetworkStatus();
                }
            }

            vibrate(pattern = [200]) {
                if (this.vibrationSupported) {
                    navigator.vibrate(pattern);
                }
            }

            handleOrientationChange() {
                setTimeout(() => {
                    if (window.innerHeight < window.innerWidth && window.innerHeight < 500) {
                        document.body.classList.add('landscape-mode');
                    } else {
                        document.body.classList.remove('landscape-mode');
                    }
                }, 100);
            }

            monitorBattery(battery) {
                const updateBatteryInfo = () => {
                    if (battery.level < 0.2 && battery.charging === false) {
                        this.showToast('Low battery detected. Consider enabling power saving mode.', 'warning');
                    }
                };

                battery.addEventListener('levelchange', updateBatteryInfo);
                battery.addEventListener('chargingchange', updateBatteryInfo);
            }

            monitorNetworkStatus() {
                const connection = navigator.connection;
                const updateNetworkInfo = () => {
                    if (connection.effectiveType === 'slow-2g' || connection.effectiveType === '2g') {
                        this.showToast('Slow connection detected. Processing may take longer.', 'warning');
                    }
                };

                connection.addEventListener('change', updateNetworkInfo);
            }

            setupTouchGestures() {
                let touchStartX, touchStartY, touchEndX, touchEndY;

                document.addEventListener('touchstart', (e) => {
                    touchStartX = e.changedTouches[0].screenX;
                    touchStartY = e.changedTouches[0].screenY;
                }, { passive: true });

                document.addEventListener('touchend', (e) => {
                    touchEndX = e.changedTouches[0].screenX;
                    touchEndY = e.changedTouches[0].screenY;
                    this.handleSwipeGesture(touchStartX, touchStartY, touchEndX, touchEndY);
                }, { passive: true });
            }

            handleSwipeGesture(startX, startY, endX, endY) {
                const deltaX = endX - startX;
                const deltaY = endY - startY;
                const minSwipeDistance = 50;

                if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > minSwipeDistance) {
                    if (deltaX > 0) {
                        // Swipe right
                        this.handleSwipeRight();
                    } else {
                        // Swipe left
                        this.handleSwipeLeft();
                    }
                }
            }

            handleSwipeRight() {
                const mobileMenu = document.getElementById('mobileMenu');
                if (mobileMenu.style.transform === 'translateX(0px)') {
                    this.closeMobileMenu();
                }
            }

            handleSwipeLeft() {
                // Could be used for navigation or other features
            }

            initializeEventListeners() {
                // Theme toggle
                document.getElementById('themeToggle').addEventListener('click', this.toggleTheme.bind(this));
                document.getElementById('mobileThemeToggle').addEventListener('click', this.toggleTheme.bind(this));
                
                // Mobile menu
                document.getElementById('mobileMenuToggle').addEventListener('click', this.toggleMobileMenu.bind(this));
                document.getElementById('closeMobileMenu').addEventListener('click', this.closeMobileMenu.bind(this));
                
                // File input
                document.getElementById('imageInput').addEventListener('change', this.handleFileSelect.bind(this));
                document.getElementById('uploadArea').addEventListener('click', () => {
                    document.getElementById('imageInput').click();
                });
                
                // Filter selection
                document.querySelectorAll('.filter-option').forEach(option => {
                    option.addEventListener('click', this.selectFilter.bind(this));
                });
                
                // Enhancement buttons
                document.getElementById('enhanceBtn').addEventListener('click', this.enhanceImages.bind(this));
                document.getElementById('batchProcessBtn').addEventListener('click', this.batchProcess.bind(this));
                
                // Action buttons
                document.getElementById('downloadBtn').addEventListener('click', this.downloadImage.bind(this));
                document.getElementById('shareBtn').addEventListener('click', this.shareImage.bind(this));
                document.getElementById('undoBtn').addEventListener('click', this.undo.bind(this));
                document.getElementById('redoBtn').addEventListener('click', this.redo.bind(this));
                
                // Premium modal
                document.getElementById('premiumBtn').addEventListener('click', this.showPremiumModal.bind(this));
                document.getElementById('closePremiumModal').addEventListener('click', this.closePremiumModal.bind(this));
                
                // FAB button
                document.getElementById('fabButton').addEventListener('click', this.handleFABClick.bind(this));
                
                // Vibration feedback for buttons
                document.querySelectorAll('.vibrate-on-tap').forEach(btn => {
                    btn.addEventListener('click', () => this.vibrate([50]));
                });
            }

            handleFABClick() {
                this.vibrate([100, 50, 100]);
                
                // Quick action menu
                const quickActions = [
                    { icon: 'fas fa-camera', text: 'Take Photo', action: this.takePhoto.bind(this) },
                    { icon: 'fas fa-image', text: 'Gallery', action: () => document.getElementById('imageInput').click() },
                    { icon: 'fas fa-magic', text: 'Quick Enhance', action: this.quickEnhance.bind(this) },
                    { icon: 'fas fa-share', text: 'Share', action: this.shareImage.bind(this) }
                ];
                
                this.showQuickActionMenu(quickActions);
            }

            showQuickActionMenu(actions) {
                const menu = document.createElement('div');
                menu.className = 'fixed bottom-20 right-4 bg-gray-800 rounded-2xl p-4 shadow-2xl z-50 animate-pulse';
                menu.innerHTML = actions.map(action => `
                    <button class="flex items-center space-x-3 w-full p-3 hover:bg-gray-700 rounded-lg transition-colors mb-2 last:mb-0" data-action="${actions.indexOf(action)}">
                        <i class="${action.icon} text-purple-400"></i>
                        <span class="text-white">${action.text}</span>
                    </button>
                `).join('');
                
                document.body.appendChild(menu);
                
                menu.addEventListener('click', (e) => {
                    const actionIndex = e.target.closest('[data-action]')?.dataset.action;
                    if (actionIndex !== undefined) {
                        actions[actionIndex].action();
                        menu.remove();
                    }
                });
                
                setTimeout(() => {
                    if (menu.parentNode) {
                        menu.remove();
                    }
                }, 5000);
            }

            async takePhoto() {
                if ('mediaDevices' in navigator && 'getUserMedia' in navigator.mediaDevices) {
                    try {
                        const stream = await navigator.mediaDevices.getUserMedia({ 
                            video: { facingMode: 'environment' } 
                        });
                        
                        const video = document.createElement('video');
                        video.srcObject = stream;
                        video.play();
                        
                        // Create camera interface
                        this.showCameraInterface(video, stream);
                    } catch (error) {
                        this.showToast('Camera access denied or not available', 'error');
                    }
                } else {
                    this.showToast('Camera not supported on this device', 'error');
                }
            }

            showCameraInterface(video, stream) {
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black z-50 flex flex-col';
                modal.innerHTML = `
                    <div class="relative flex-1 overflow-hidden">
                        <video id="cameraVideo" class="w-full h-full object-cover" autoplay playsinline></video>
                        <canvas id="cameraCanvas" class="hidden"></canvas>
                        <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-4">
                            <button id="captureBtn" class="w-16 h-16 bg-white rounded-full flex items-center justify-center">
                                <i class="fas fa-camera text-2xl text-gray-800"></i>
                            </button>
                            <button id="closeCameraBtn" class="w-12 h-12 bg-gray-800 rounded-full flex items-center justify-center">
                                <i class="fas fa-times text-white"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                const videoElement = modal.querySelector('#cameraVideo');
                videoElement.srcObject = stream;
                
                modal.querySelector('#captureBtn').addEventListener('click', () => {
                    this.capturePhoto(videoElement, stream);
                    modal.remove();
                });
                
                modal.querySelector('#closeCameraBtn').addEventListener('click', () => {
                    stream.getTracks().forEach(track => track.stop());
                    modal.remove();
                });
            }

            capturePhoto(video, stream) {
                const canvas = document.createElement('canvas');
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                
                const ctx = canvas.getContext('2d');
                ctx.drawImage(video, 0, 0);
                
                canvas.toBlob(blob => {
                    const file = new File([blob], `camera-${Date.now()}.jpg`, { type: 'image/jpeg' });
                    this.processFiles([file]);
                }, 'image/jpeg', 0.9);
                
                stream.getTracks().forEach(track => track.stop());
                this.vibrate([200]);
                this.showToast('Photo captured successfully!', 'success');
            }

            quickEnhance() {
                if (this.images.length > 0) {
                    this.enhanceImages();
                } else {
                    this.showToast('Please select images first', 'warning');
                }
            }

            setupDragAndDrop() {
                const uploadArea = document.getElementById('uploadArea');
                
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    uploadArea.addEventListener(eventName, this.preventDefaults, false);
                });
                
                ['dragenter', 'dragover'].forEach(eventName => {
                    uploadArea.addEventListener(eventName, () => {
                        uploadArea.classList.add('drag-over');
                        this.vibrate([100]);
                    }, false);
                });
                
                ['dragleave', 'drop'].forEach(eventName => {
                    uploadArea.addEventListener(eventName, () => uploadArea.classList.remove('drag-over'), false);
                });
                
                uploadArea.addEventListener('drop', this.handleDrop.bind(this), false);
            }

            setupComparisonSlider() {
                const slider = document.getElementById('comparisonDivider');
                const overlay = document.getElementById('comparisonOverlay');
                const container = document.getElementById('comparisonSlider');
                
                let isDown = false;
                let startX = 0;
                
                // Mouse events
                slider.addEventListener('mousedown', (e) => {
                    isDown = true;
                    startX = e.clientX;
                    this.vibrate([50]);
                });
                
                document.addEventListener('mouseup', () => isDown = false);
                
                container.addEventListener('mousemove', (e) => {
                    if (!isDown) return;
                    this.updateSliderPosition(e.clientX, container);
                });
                
                // Touch events
                slider.addEventListener('touchstart', (e) => {
                    isDown = true;
                    startX = e.touches[0].clientX;
                    this.vibrate([50]);
                    e.preventDefault();
                });
                
                document.addEventListener('touchend', () => isDown = false);
                
                container.addEventListener('touchmove', (e) => {
                    if (!isDown) return;
                    this.updateSliderPosition(e.touches[0].clientX, container);
                    this.vibrate([10]);
                    e.preventDefault();
                });
            }

            updateSliderPosition(clientX, container) {
                const rect = container.getBoundingClientRect();
                const x = clientX - rect.left;
                const percentage = Math.max(0, Math.min(100, (x / rect.width) * 100));
                
                document.getElementById('comparisonDivider').style.left = `${percentage}%`;
                document.getElementById('comparisonOverlay').style.width = `${100 - percentage}%`;
            }

            preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                this.processFiles(files);
                this.vibrate([200]);
            }

            handleFileSelect(e) {
                const files = e.target.files;
                this.processFiles(files);
            }

            async processFiles(files) {
                const validFiles = Array.from(files).filter(file => file.type.startsWith('image/'));
                
                if (validFiles.length === 0) {
                    this.showToast('Please select valid image files', 'error');
                    this.vibrate([300, 100, 300]);
                    return;
                }
                
                this.showToast('Processing images...', 'info');
                this.images = [];
                const imageGrid = document.getElementById('imageGrid');
                imageGrid.innerHTML = '';
                imageGrid.classList.remove('hidden');
                
                for (const file of validFiles) {
                    try {
                        const compressedFile = await this.compressImage(file);
                        const imageData = {
                            file: compressedFile,
                            original: URL.createObjectURL(compressedFile),
                            enhanced: null,
                            name: file.name
                        };
                        
                        this.images.push(imageData);
                        this.createImagePreview(imageData, this.images.length - 1);
                    } catch (error) {
                        console.error('Error processing file:', error);
                        this.showToast(`Error processing ${file.name}`, 'error');
                    }
                }
                
                document.getElementById('enhanceBtn').disabled = this.images.length === 0;
                document.getElementById('batchProcessBtn').disabled = this.images.length === 0;
                
                this.showToast(`${this.images.length} image(s) loaded successfully`, 'success');
                this.vibrate([100, 50, 100]);
            }

            createImagePreview(imageData, index) {
                const imageGrid = document.getElementById('imageGrid');
                
                const imageCard = document.createElement('div');
                imageCard.className = 'image-container bg-gray-800 p-4 rounded-2xl gpu-accelerated';
                imageCard.innerHTML = `
                    <img src="${imageData.original}" alt="${imageData.name}" 
                         class="w-full h-48 object-cover rounded-xl mb-3 skeleton" 
                         loading="lazy" onload="this.classList.remove('skeleton')">
                    <div class="flex justify-between items-center">
                        <div class="flex-1 mr-3">
                            <span class="text-sm font-medium text-white block truncate">${imageData.name}</span>
                            <span class="text-xs text-gray-400">Image ${index + 1}</span>
                        </div>
                        <button class="text-red-400 hover:text-red-300 p-2 rounded-lg hover:bg-red-400 hover:bg-opacity-10 transition-all vibrate-on-tap" 
                                onclick="picshine.removeImage(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                imageGrid.appendChild(imageCard);
            }

            removeImage(index) {
                this.images.splice(index, 1);
                this.updateImageGrid();
                this.vibrate([100]);
                
                if (this.images.length === 0) {
                    document.getElementById('imageGrid').classList.add('hidden');
                    document.getElementById('enhanceBtn').disabled = true;
                    document.getElementById('batchProcessBtn').disabled = true;
                }
                
                this.showToast('Image removed', 'info');
            }

            updateImageGrid() {
                const imageGrid = document.getElementById('imageGrid');
                imageGrid.innerHTML = '';
                
                this.images.forEach((imageData, index) => {
                    this.createImagePreview(imageData, index);
                });
            }

            async compressImage(file) {
                return new Promise((resolve) => {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    const img = new Image();
                    
                    img.onload = () => {
                        const maxSize = window.innerWidth < 768 ? 1280 : 1920;
                        let { width, height } = img;
                        
                        if (width > height && width > maxSize) {
                            height = (height * maxSize) / width;
                            width = maxSize;
                        } else if (height > maxSize) {
                            width = (width * maxSize) / height;
                            height = maxSize;
                        }
                        
                        canvas.width = width;
                        canvas.height = height;
                        
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        const quality = window.innerWidth < 768 ? 0.7 : 0.8;
                        canvas.toBlob(resolve, 'image/jpeg', quality);
                    };
                    
                    img.src = URL.createObjectURL(file);
                });
            }

            selectFilter(e) {
                document.querySelectorAll('.filter-option').forEach(option => {
                    option.classList.remove('active');
                });
                
                e.currentTarget.classList.add('active');
                this.currentFilter = e.currentTarget.dataset.filter;
                this.vibrate([50]);
                
                // Animate selection
                e.currentTarget.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    e.currentTarget.style.transform = '';
                }, 150);
            }

            async enhanceImages() {
                if (this.images.length === 0 || this.isProcessing) return;
                
                this.isProcessing = true;
                this.showProgress();
                this.vibrate([100]);
                
                try {
                    const firstImage = this.images[0];
                    
                    // Simulate progressive enhancement
                    for (let i = 0; i <= 100; i += 5) {
                        this.updateProgress(i, `Enhancing with ${this.currentFilter}...`);
                        await new Promise(resolve => setTimeout(resolve, 50));
                    }
                    
                    const enhancedImage = await this.applyEnhancement(firstImage.original, this.currentFilter);
                    firstImage.enhanced = enhancedImage;
                    
                    this.showComparison(firstImage.original, enhancedImage);
                    this.addToHistory(firstImage);
                    
                    this.hideProgress();
                    this.showActionButtons();
                    
                    this.showToast('Image enhanced successfully!', 'success');
                    this.vibrate([200, 100, 200]);
                } catch (error) {
                    console.error('Enhancement error:', error);
                    this.hideProgress();
                    this.showToast('Enhancement failed. Please try again.', 'error');
                    this.vibrate([300, 100, 300]);
                } finally {
                    this.isProcessing = false;
                }
            }

            async batchProcess() {
                if (this.images.length === 0 || this.isProcessing) return;
                
                this.isProcessing = true;
                this.showProgress();
                this.vibrate([100, 50, 100]);
                
                try {
                    for (let i = 0; i < this.images.length; i++) {
                        const image = this.images[i];
                        const progress = ((i + 1) / this.images.length) * 100;
                        
                        this.updateProgress(progress, `Processing image ${i + 1} of ${this.images.length}`);
                        
                        image.enhanced = await this.applyEnhancement(image.original, this.currentFilter);
                        
                        // Haptic feedback for each completed image
                        this.vibrate([50]);
                        
                        await new Promise(resolve => setTimeout(resolve, 800));
                    }
                    
                    this.hideProgress();
                    this.showToast(`${this.images.length} images enhanced successfully!`, 'success');
                    this.vibrate([200, 100, 200, 100, 200]);
                    
                    const firstImage = this.images[0];
                    this.showComparison(firstImage.original, firstImage.enhanced);
                    this.showActionButtons();
                } catch (error) {
                    console.error('Batch processing error:', error);
                    this.hideProgress();
                    this.showToast('Batch processing failed. Please try again.', 'error');
                    this.vibrate([300, 100, 300]);
                } finally {
                    this.isProcessing = false;
                }
            }

            async applyEnhancement(imageSrc, filter) {
                return new Promise((resolve) => {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    const img = new Image();
                    
                    img.onload = () => {
                        canvas.width = img.width;
                        canvas.height = img.height;
                        
                        ctx.drawImage(img, 0, 0);
                        
                        // Apply mobile-optimized filters
                        switch (filter) {
                            case 'super-resolution':
                                this.applySuperResolution(ctx, canvas);
                                break;
                            case 'face-enhance':
                                this.applyFaceEnhancement(ctx, canvas);
                                break;
                            case 'colorize':
                                this.applyColorization(ctx, canvas);
                                break;
                            case 'denoise':
                                this.applyDenoising(ctx, canvas);
                                break;
                            case 'sharpen':
                                this.applySharpening(ctx, canvas);
                                break;
                            case 'vintage':
                                this.applyVintageEffect(ctx, canvas);
                                break;
                        }
                        
                        const quality = window.innerWidth < 768 ? 0.85 : 0.9;
                        resolve(canvas.toDataURL('image/jpeg', quality));
                    };
                    
                    img.src = imageSrc;
                });
            }

            // Enhanced mobile-optimized filters
            applySuperResolution(ctx, canvas) {
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                
                // Mobile-optimized sharpening
                const sharpenKernel = [
                    0, -0.8, 0,
                    -0.8, 4.2, -0.8,
                    0, -0.8, 0
                ];
                
                this.applyConvolution(data, canvas.width, canvas.height, sharpenKernel);
                
                // Enhanced contrast for mobile viewing
                for (let i = 0; i < data.length; i += 4) {
                    data[i] = Math.min(255, data[i] * 1.15);
                    data[i + 1] = Math.min(255, data[i + 1] * 1.15);
                    data[i + 2] = Math.min(255, data[i + 2] * 1.15);
                }
                
                ctx.putImageData(imageData, 0, 0);
            }

            applyFaceEnhancement(ctx, canvas) {
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                
                // Enhanced skin tone detection and improvement
                for (let i = 0; i < data.length; i += 4) {
                    const r = data[i];
                    const g = data[i + 1];
                    const b = data[i + 2];
                    
                    // Improved skin tone detection
                    if (r > 95 && g > 40 && b > 20 && r > g && r > b && (r - g) > 15) {
                        data[i] = Math.min(255, r * 1.12);
                        data[i + 1] = Math.min(255, g * 1.08);
                        data[i + 2] = Math.min(255, b * 1.02);
                    }
                }
                
                ctx.putImageData(imageData, 0, 0);
            }

            applyColorization(ctx, canvas) {
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                
                // Advanced colorization with multiple tones
                for (let i = 0; i < data.length; i += 4) {
                    const gray = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;
                    
                    // Warm sepia with color variation
                    const warmth = Math.sin(i * 0.001) * 0.1 + 1.2;
                    data[i] = Math.min(255, gray * warmth);
                    data[i + 1] = Math.min(255, gray * (warmth - 0.1));
                    data[i + 2] = Math.min(255, gray * (warmth - 0.3));
                }
                
                ctx.putImageData(imageData, 0, 0);
            }

            applyDenoising(ctx, canvas) {
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                
                // Gentle gaussian blur for noise reduction
                const blurKernel = [
                    1, 2, 1,
                    2, 4, 2,
                    1, 2, 1
                ];
                
                this.applyConvolution(data, canvas.width, canvas.height, blurKernel, 16);
                ctx.putImageData(imageData, 0, 0);
            }

            applySharpening(ctx, canvas) {
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                
                // Mobile-optimized sharpening
                const sharpenKernel = [
                    0, -1, 0,
                    -1, 5.5, -1,
                    0, -1, 0
                ];
                
                this.applyConvolution(data, canvas.width, canvas.height, sharpenKernel, 1.5);
                ctx.putImageData(imageData, 0, 0);
            }

            applyVintageEffect(ctx, canvas) {
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                
                // Enhanced vintage with vignette effect
                const centerX = canvas.width / 2;
                const centerY = canvas.height / 2;
                const maxDistance = Math.sqrt(centerX * centerX + centerY * centerY);
                
                for (let y = 0; y < canvas.height; y++) {
                    for (let x = 0; x < canvas.width; x++) {
                        const i = (y * canvas.width + x) * 4;
                        const r = data[i];
                        const g = data[i + 1];
                        const b = data[i + 2];
                        
                        // Vintage color transformation
                        data[i] = Math.min(255, r * 1.25 + g * 0.15);
                        data[i + 1] = Math.min(255, r * 0.15 + g * 1.15);
                        data[i + 2] = Math.min(255, b * 0.85);
                        
                        // Vignette effect
                        const distance = Math.sqrt((x - centerX) * (x - centerX) + (y - centerY) * (y - centerY));
                        const vignette = 1 - (distance / maxDistance) * 0.3;
                        
                        data[i] = Math.min(255, data[i] * vignette);
                        data[i + 1] = Math.min(255, data[i + 1] * vignette);
                        data[i + 2] = Math.min(255, data[i + 2] * vignette);
                    }
                }
                
                ctx.putImageData(imageData, 0, 0);
            }

            applyConvolution(data, width, height, kernel, divisor = 1) {
                const output = new Uint8ClampedArray(data.length);
                const kernelSize = Math.sqrt(kernel.length);
                const halfKernel = Math.floor(kernelSize / 2);
                
                for (let y = halfKernel; y < height - halfKernel; y++) {
                    for (let x = halfKernel; x < width - halfKernel; x++) {
                        for (let c = 0; c < 3; c++) {
                            let sum = 0;
                            
                            for (let ky = 0; ky < kernelSize; ky++) {
                                for (let kx = 0; kx < kernelSize; kx++) {
                                    const pixelY = y + ky - halfKernel;
                                    const pixelX = x + kx - halfKernel;
                                    const pixelIndex = (pixelY * width + pixelX) * 4 + c;
                                    const kernelIndex = ky * kernelSize + kx;
                                    
                                    sum += data[pixelIndex] * kernel[kernelIndex];
                                }
                            }
                            
                            const outputIndex = (y * width + x) * 4 + c;
                            output[outputIndex] = Math.min(255, Math.max(0, sum / divisor));
                        }
                        
                        const alphaIndex = (y * width + x) * 4 + 3;
                        output[alphaIndex] = data[alphaIndex];
                    }
                }
                
                data.set(output);
            }

            showProgress() {
                document.getElementById('progressArea').classList.remove('hidden');
                this.updateProgress(0, 'Initializing AI enhancement...');
            }

            updateProgress(percentage, text) {
                const progressBar = document.getElementById('progressBar');
                const progressText = document.getElementById('progressText');
                
                progressBar.style.width = `${percentage}%`;
                progressText.textContent = `${Math.round(percentage)}%`;
                
                if (text) {
                    document.querySelector('#progressArea span').textContent = text;
                }
            }

            hideProgress() {
                document.getElementById('progressArea').classList.add('hidden');
            }

            showComparison(original, enhanced) {
                document.getElementById('originalImage').src = original;
                document.getElementById('enhancedImage').src = enhanced;
                document.getElementById('comparisonArea').classList.remove('hidden');
                
                // Reset slider position
                document.getElementById('comparisonDivider').style.left = '50%';
                document.getElementById('comparisonOverlay').style.width = '50%';
                
                // Auto-animate comparison
                setTimeout(() => {
                    this.animateComparison();
                }, 500);
            }

            animateComparison() {
                const divider = document.getElementById('comparisonDivider');
                const overlay = document.getElementById('comparisonOverlay');
                
                let position = 50;
                let direction = -1;
                let iterations = 0;
                
                const animate = () => {
                    position += direction * 2;
                    
                    if (position <= 20 || position >= 80) {
                        direction *= -1;
                        iterations++;
                    }
                    
                    divider.style.left = `${position}%`;
                    overlay.style.width = `${100 - position}%`;
                    
                    if (iterations < 4) {
                        requestAnimationFrame(animate);
                    } else {
                        // Reset to center
                        divider.style.left = '50%';
                        overlay.style.width = '50%';
                    }
                };
                
                animate();
            }

            showActionButtons() {
                document.getElementById('actionButtons').classList.remove('hidden');
            }

            addToHistory(imageData) {
                this.history = this.history.slice(0, this.historyIndex + 1);
                this.history.push({
                    original: imageData.original,
                    enhanced: imageData.enhanced
                });
                this.historyIndex++;
                this.updateHistoryButtons();
            }

            updateHistoryButtons() {
                document.getElementById('undoBtn').disabled = this.historyIndex <= 0;
                document.getElementById('redoBtn').disabled = this.historyIndex >= this.history.length - 1;
            }

            undo() {
                if (this.historyIndex > 0) {
                    this.historyIndex--;
                    const historyItem = this.history[this.historyIndex];
                    this.showComparison(historyItem.original, historyItem.enhanced);
                    this.updateHistoryButtons();
                    this.vibrate([100]);
                }
            }

            redo() {
                if (this.historyIndex < this.history.length - 1) {
                    this.historyIndex++;
                    const historyItem = this.history[this.historyIndex];
                    this.showComparison(historyItem.original, historyItem.enhanced);
                    this.updateHistoryButtons();
                    this.vibrate([100]);
                }
            }

            downloadImage() {
                const enhancedImage = document.getElementById('enhancedImage');
                if (enhancedImage.src) {
                    const link = document.createElement('a');
                    link.download = `picshine-enhanced-${Date.now()}.jpg`;
                    link.href = enhancedImage.src;
                    link.click();
                    
                    this.showToast('Image downloaded successfully!', 'success');
                    this.vibrate([200]);
                }
            }

            async shareImage() {
                const enhancedImage = document.getElementById('enhancedImage');
                
                if (navigator.share && enhancedImage.src) {
                    try {
                        const response = await fetch(enhancedImage.src);
                        const blob = await response.blob();
                        const file = new File([blob], 'picshine-enhanced.jpg', { type: 'image/jpeg' });
                        
                        await navigator.share({
                            title: 'Enhanced with PicShine AI',
                            text: 'Check out my AI-enhanced photo! ðŸ“¸âœ¨',
                            files: [file]
                        });
                        
                        this.showToast('Image shared successfully!', 'success');
                        this.vibrate([100, 50, 100]);
                    } catch (error) {
                        if (error.name !== 'AbortError') {
                            this.fallbackShare();
                        }
                    }
                } else {
                    this.fallbackShare();
                }
            }

            fallbackShare() {
                const shareData = {
                    title: 'PicShine AI - Photo Enhancement',
                    text: 'Transform your photos with AI! ðŸš€',
                    url: window.location.href
                };
                
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(`${shareData.text} ${shareData.url}`).then(() => {
                        this.showToast('Link copied to clipboard!', 'success');
                        this.vibrate([100]);
                    });
                } else {
                    this.showToast('Sharing not supported on this device', 'error');
                }
            }

            toggleTheme() {
                document.body.classList.toggle('light-mode');
                const isDark = !document.body.classList.contains('light-mode');
                
                const moonIcon = '<i class="fas fa-moon"></i>';
                const sunIcon = '<i class="fas fa-sun"></i>';
                
                document.getElementById('themeToggle').innerHTML = isDark ? moonIcon : sunIcon;
                document.getElementById('mobileThemeToggle').innerHTML = isDark ? 
                    `${moonIcon} <span>Dark Mode</span>` : 
                    `${sunIcon} <span>Light Mode</span>`;
                
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
                this.vibrate([50]);
            }

            toggleMobileMenu() {
                const mobileMenu = document.getElementById('mobileMenu');
                mobileMenu.style.transform = 'translateX(0)';
                this.vibrate([100]);
            }

            closeMobileMenu() {
                const mobileMenu = document.getElementById('mobileMenu');
                mobileMenu.style.transform = 'translateX(100%)';
            }

            showPremiumModal() {
                document.getElementById('premiumModal').classList.add('show');
                this.vibrate([100]);
            }

            closePremiumModal() {
                document.getElementById('premiumModal').classList.remove('show');
            }

            showInstallPrompt() {
                if (window.matchMedia('(display-mode: browser)').matches) {
                    setTimeout(() => {
                        this.showToast('Install PicShine AI for better experience! ðŸ“±', 'info');
                    }, 3000);
                }
            }

            showToast(message, type = 'info') {
                const toastContainer = document.getElementById('toastContainer');
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                
                const icons = {
                    success: 'fas fa-check-circle',
                    error: 'fas fa-exclamation-circle',
                    warning: 'fas fa-exclamation-triangle',
                    info: 'fas fa-info-circle'
                };
                
                toast.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <i class="${icons[type]} text-lg"></i>
                        <span class="flex-1">${message}</span>
                        <button onclick="this.parentElement.parentElement.remove()" class="text-gray-400 hover:text-white">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                
                toastContainer.appendChild(toast);
                
                setTimeout(() => toast.classList.add('show'), 100);
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => toast.remove(), 300);
                }, 4000);
            }

            init() {
                // Load saved theme
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme === 'light') {
                    document.body.classList.add('light-mode');
                    document.getElementById('themeToggle').innerHTML = '<i class="fas fa-sun"></i>';
                    document.getElementById('mobileThemeToggle').innerHTML = '<i class="fas fa-sun"></i> <span>Light Mode</span>';
                }
                
                // Handle orientation changes
                this.handleOrientationChange();
                
                // Close mobile menu on outside click
                document.addEventListener('click', (e) => {
                    const mobileMenu = document.getElementById('mobileMenu');
                    const menuToggle = document.getElementById('mobileMenuToggle');
                    
                    if (!mobileMenu.contains(e.target) && !menuToggle.contains(e.target)) {
                        this.closeMobileMenu();
                    }
                });
                
                // Close premium modal on outside click
                document.getElementById('premiumModal').addEventListener('click', (e) => {
                    if (e.target.id === 'premiumModal') {
                        this.closePremiumModal();
                    }
                });
                
                // Performance optimizations
                this.optimizePerformance();
                
                console.log('PicShine AI Mobile Enhanced initialized successfully! ðŸš€');
                this.showToast('Welcome to PicShine AI! ðŸŽ‰', 'success');
            }

            optimizePerformance() {
                // Lazy load images
                if ('IntersectionObserver' in window) {
                    const imageObserver = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                const img = entry.target;
                                img.src = img.dataset.src;
                                img.classList.remove('skeleton');
                                imageObserver.unobserve(img);
                            }
                        });
                    });
                    
                    document.querySelectorAll('img[data-src]').forEach(img => {
                        imageObserver.observe(img);
                    });
                }
                
                // Preload critical resources
                const criticalResources = [
                    'https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css',
                    'https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css'
                ];
                
                criticalResources.forEach(resource => {
                    const link = document.createElement('link');
                    link.rel = 'preload';
                    link.as = 'style';
                    link.href = resource;
                    document.head.appendChild(link);
                });
                
                // Memory management
                this.setupMemoryManagement();
            }

            setupMemoryManagement() {
                // Clean up unused image URLs
                setInterval(() => {
                    this.images = this.images.filter(img => {
                        if (!img.enhanced && !document.querySelector(`img[src="${img.original}"]`)) {
                            URL.revokeObjectURL(img.original);
                            return false;
                        }
                        return true;
                    });
                }, 30000);
                
                // Monitor memory usage
                if ('memory' in performance) {
                    setInterval(() => {
                        const memInfo = performance.memory;
                        if (memInfo.usedJSHeapSize > memInfo.jsHeapSizeLimit * 0.8) {
                            this.showToast('Memory usage high. Consider refreshing the page.', 'warning');
                        }
                    }, 60000);
                }
            }
        }

        // Initialize the application
        const picshine = new PicShineAI();
        
        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => picshine.init());
        } else {
            picshine.init();
        }
        
        // Handle app state changes
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                // App went to background
                console.log('App backgrounded');
            } else {
                // App came to foreground
                console.log('App foregrounded');
            }
        });
        
        // Handle network status changes
        window.addEventListener('online', () => {
            picshine.showToast('Connection restored! ðŸŒ', 'success');
        });
        
        window.addEventListener('offline', () => {
            picshine.showToast('You are offline. Some features may not work.', 'warning');
        });
        
        // Handle app installation
        window.addEventListener('appinstalled', () => {
            picshine.showToast('PicShine AI installed successfully! ðŸŽ‰', 'success');
        });
    </script>
</body>
</html>
